<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.geometry.Orientation?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx/25"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.algolab.controller.MainMenuController"
            prefWidth="1200.0" prefHeight="800.0"
            stylesheets="@../styles/darkTheme.css">

    <!-- ============ TOP: MENU BAR ============ -->
    <top>
        <VBox spacing="0">
            <MenuBar fx:id="menuBar">
                <menus>
                    <!-- FILE -->
                    <Menu text="File">
                        <items>
                            <Menu text="New DataBase">
                                <items>
                                    <MenuItem text="New Array" onAction="#newArray"/>
                                    <MenuItem text="New Linked-List" onAction="#newLinkedList"/>
                                    <MenuItem text="New Binary-Tree" onAction="#newBinaryTree"/>
                                    <MenuItem text="New Stack" onAction="#newStack"/>
                                    <MenuItem text="New Queue" onAction="#newQueue"/>
                                    <MenuItem text="New Graph" onAction="#newGraph"/>
                                </items>
                            </Menu>
                            <MenuItem fx:id="newFolderMenuItem" text="New Folder..." onAction="#handleNewFolder"/>
                            <SeparatorMenuItem/>
                            <MenuItem fx:id="saveMenuItem" text="Save"/>
                            <MenuItem fx:id="saveAllMenuItem" text="Save All"/>
                            <SeparatorMenuItem/>
                            <MenuItem fx:id="signOutMenuItem" text="Sign Out" onAction="#logout"/>
                            <MenuItem fx:id="exitMenuItem" text="Exit"/>
                        </items>
                    </Menu>

                    <fx:define>
                        <ToggleGroup fx:id="viewToggle"/>
                    </fx:define>

                    <!-- VIEW -->
                    <Menu text="View">
                        <items>
                            <RadioMenuItem fx:id="viewVisualMenuItem" text="Visual View" selected="true" toggleGroup="$viewToggle"/>
                            <RadioMenuItem fx:id="viewTableMenuItem" text="Table View" toggleGroup="$viewToggle"/>
                            <RadioMenuItem fx:id="viewSplitMenuItem" text="Split View" toggleGroup="$viewToggle"/>
                        </items>
                    </Menu>

                    <!-- ALGORITHMS (menu-level shortcuts later if you want) -->
                    <Menu text="Algorithms">
                        <items>
                            <MenuItem fx:id="runLastAlgorithmMenuItem" text="Run Last Algorithm"/>
                            <MenuItem fx:id="clearAlgorithmOutputMenuItem" text="Clear Output"/>
                        </items>
                    </Menu>

                    <!-- SETTINGS -->
                    <Menu text="Settings">
                        <items>
                            <MenuItem fx:id="preferencesMenuItem" text="Preferences..."/>
                            <MenuItem fx:id="themeMenuItem" text="Theme..."/>
                        </items>
                    </Menu>

                    <!-- HELP -->
                    <Menu text="Help">
                        <items>
                            <MenuItem fx:id="aboutMenuItem" text="About AlgoLab..."/>
                        </items>
                    </Menu>
                </menus>
            </MenuBar>
        </VBox>
    </top>

    <!-- ============ CENTER: MAIN LAYOUT (3 PANELS) ============ -->
    <center>
        <!-- Horizontal SplitPane: [LEFT][CENTER][RIGHT] -->
        <SplitPane dividerPositions="0.18, 0.78" orientation="HORIZONTAL">
            <items>

                <!-- ============ Left: DATABASE EXPLORER ============ -->
                <VBox fx:id="leftPanel" styleClass="panel-left" spacing="4.0">
                    <padding>
                        <Insets top="6" right="6" bottom="6" left="6"/>
                    </padding>
                    <children>
                        <!-- Title + New / Folder buttons -->
                        <HBox alignment="CENTER_LEFT" spacing="4">
                            <Label text="Databases" styleClass="panel-title"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Button fx:id="newDatabaseButton" text="New" styleClass="accent-button"/>
                            <Button fx:id="newFolderButton" text="Folder" styleClass="ghost-button" onAction="#handleNewFolder"/>
                        </HBox>

                        <!-- Tree of databases / folders -->
                        <TreeView fx:id="databaseTreeView" VBox.vgrow="ALWAYS"/>

                    </children>
                </VBox>

                <!-- ============ Center: ACTIVE DATABASE VIEW ============ -->
                <BorderPane fx:id="centerPanel" styleClass="panel-center">
                    
                    <!-- Tabs: Visual & Table view (we can sync with menu + toggles) -->
                    <center>
                        <TabPane fx:id="viewTabPane">
                            <tabs>
                                <Tab fx:id="visualTab" text="New page" closable="true">
                                    <content>
                                        <!-- Placeholder for now: canvas / zoomable pane later -->
                                        <StackPane fx:id="visualViewContainer" styleClass="visual-placeholder">
                                            <Label text="Go to file -> create datastructure for an easy start" styleClass="placeholder-text"/>
                                        </StackPane>
                                    </content>
                                </Tab>
                                <Tab fx:id="visualTab" text="New page" closable="true">
                                    <content>
                                        <!-- Placeholder for now: canvas / zoomable pane later -->
                                        <StackPane fx:id="visualViewContainer" styleClass="visual-placeholder">
                                            <Label text="Go to file -> create datastructure for an easy start" styleClass="placeholder-text"/>
                                        </StackPane>
                                    </content>
                                </Tab>
                            </tabs>
                        </TabPane>
                    </center>

                </BorderPane>

                <!-- ============ Right: ALGORITHMS PANEL ============ -->
                <VBox fx:id="rightPanel" styleClass="panel-right" spacing="4.0">
                    <padding>
                        <Insets top="6" right="6" bottom="6" left="6"/>
                    </padding>
                    <children>
                        <Label text="Algorithms" styleClass="panel-title"/>
                    </children>
                </VBox>

            </items>
        </SplitPane>
    </center>

    <!-- ============ BOTTOM: STATUS BAR ============ -->
    <bottom>
        <HBox fx:id="statusBar" styleClass="status-bar" spacing="12" alignment="CENTER_LEFT">
            <padding>
                <Insets top="2" right="8" bottom="2" left="8"/>
            </padding>
            <children>
                <Label fx:id="statusUserLabel" text="User: (guest)"/>
                <Label text="|" styleClass="status-separator"/>
                <Label fx:id="statusVersionLabel" text="Version: 0.1.0"/>
                <Label text="|" styleClass="status-separator"/>
                <Label fx:id="statusLastSavedLabel" text="Last saved: never"/>
            </children>
        </HBox>
    </bottom>

</BorderPane>
